MODE=NOLSTOP;
SC=2000;

MODULE huhu;

SYSTEM;
   A1: <->;

PROBLEM;
   SPC A1 DATION INOUT ALPHIC;

DCL Start FIXED;

DCL MySema SEMA;

#define abc "123"
#define def "D"
#define ghi
#define jkl "IF 1==2 THEN FX = 9; FIN"

#include testinc.h
#include "testinc.h"

DCL bAktiv BIT;


#ifndef InclDir
  #define InclDir "'/home/jan/pearl-lsp'"
#endif

#include InclDir/testinc.h
#include "InclDir/testinc.h"

#define ghi "fehler"
#undef nohave

#huhu


/* 
Hallo: PROC;

*/

#define mydef
#define mydef2

#ifdef mydef
DCL MyDef FIXED;
#ifndef mydef2
DCL MyDef_2 FIXED;
#else
DCL MyDef_2_2 FIXED;
#define NotActive
#endif
#else
DCL MyDef2 FIXED;
#ifndef mydef2
DCL MyDef_2 FIXED;
#else
DCL MyDef_2_2 FIXED;
#endif
#endif

#ifndef NotActive
!Hier nicht aktiver Abschnitt
SPC InActive BIT;
#endif

SPC somethingSPC ENTRY GLOBAL;
DCL A DURATION;
DCL (B,B1) REF CLOCK;
DCL X FLOAT;
SPC demo TASK;
DCL STR CHAR(20);
DCL UnusedGlobalVar FIXED;
DCL UnusedGlobalVarGlobal FIXED GLOBAL;
DCL Var FIXED;  ! Verwendung per Makro defVar
#define defVar "Var"

somethingGlobal: PROC RETURNS( FIXED ) GLOBAL;
   defVar = 1;
   RETURN 1;
END;

something: PROC( D DATION INOUT ALPHIC IDENT, A FIXED, B FLOAT);
DCL (X,UnusedLocalVar) FIXED;
A = abc;
B = A * 1.0;
X = A;
ACTIVATE demo;
STR = 'IF';
STR.CHAR(3) = 'D';
PUT STR TO D BY LIST,SKIP;
CALL GlobProc;    ! Aus Include-Datei
SEMASET 3, MySema;
REQUEST MySema;
END;

demo: TASK PRIO 8;
DCL x FIXED INIT(8);
DCL y FLOAT INIT(8.15);
DCL somethingREF REF PROC RETURNS( FIXED(31) );
DCL retVal FIXED(31);
DCL myTask REF TASK;
x = -7;
UnusedLabel:
y := 47.11E+10;
AlreadyDefinedLabel:
IF x = 0 THEN     ! Operator = ist Fehler!
   ! Kommentar
   CALL something( A1, 5,12.3 );
   something( A1, 5,12.3 );
   CALL somethingUndefined;
   retVal = somethingREF();
   GOTO UndefinedLabel;
   CALL something;
   GOTO AlreadyDefinedLabel;
FIN;
IF x = 0 THEN     ! Operator = ist Fehler!
   ! Kommentar
   CALL something( A1, 5,12.3 );
   CALL somethingSPC;
   CALL somethingREF;
   GOTO MyLabel;
   /* noch
   ein
   Kommentar */
ELSE
! ELSE wird bei Folding auch unterst√ºtzt.
   CALL somethingSPC;
FIN;
myTask = demo;
CALL REFADD( myTask, 1);
ACTIVATE;
ACTIVATE myTask ALL 1 SEC;
ACTIVATE myTask 10;
ACTIVATE myTask;
ACTIVATE myTask PRIO 10;
SUSPEND myTask;
SUSPEND;
CONTINUE myTask;
CONTINUE myTask PRIO 11;
AFTER 10 SEC RESUME;
TERMINATE myTask;
TERMINATE;
PREVENT myTask;
PREVENT;
WHILE ( 1==2
AND 3 == 4 ) REPEAT
 x = 2 * x;
END;

BEGIN ! hier kommentar mit 'String' X
DCL AFDim1 INV FIXED INIT(3);
DCL I FIXED, X FLOAT, AF (AFDim1,4)FIXED, T CLOCK, D DURATION;

DCL Doppelt FIXED;
DCL Doppelt FLOAT;

DCL MyBolt REF BOLT;
DCL MyArr (4,5)FLOAT;
DCL something FIXED;

!DCL Ch CHAR(10);

something = 2;

LEAVE MyBolt;

Ch = '!Huhu';

I := 123(31); ! Noch einer
I := 110B;

X := .123E2;
X := 3.14E-10(23);

T := 15:45:3.5;

D := 5 MIN 30 SEC;
D := .05 SEC;
D := 5 HRS 10 SEC;
def := 2 MIN;
#undef def
def := 3 MIN;
jkl;
IF 1==2 THEN FY = 9; FIN;


FOR I2 FROM 3 TO 5 WHILE I2 < 10 REPEAT
  X = I2;
END;

A := '110010100111'B1;
B := '302213'B2;
C := '6247'B3;
H := 'CA7'B4;
B1 := '1'B;
END;
MyLabel:
CALL something;
X = 7;   
END;

/* 
Hallo: PROC;
CALL something;
*/

SPC P2 PROC( FIXED, FIXED );

T2: TASK;
   CALL P2(1,2);
   P2(1,2);
END;

P2: PROC( A FIXED, B FIXED );
  A := 1;
END;

MODEND;
